---
layout: post
title:  "[디자인 패턴] Observer pattern (옵저버 패턴)"
categories: [pattern]
img: use-post/design-pattern.jpg
toc: true
---

이번주에 알아볼 패턴은 **옵저버 패턴** 입니다. 분산 이벤트를 핸들링 해야 할 때 주로 사용한다 하며 발행/구독 모델로 알려져 있다고도 하네요. 

저번 시간과 동일하게 **옵저버** 라는 단어가 뭔지부터 확인해보도록 합시다.

## Observer 란?

---
> observer
> 명사
> 1. 보는 사람, 목격자
> 2. (회의·수업 등의) 참관인[옵서버]
> 3. 관찰자; 관측자

위와 같이 옵저버 란 지켜보는 것이라 할 수 있습니다. 게임에서도 여기 저기 관찰하기 위해 돌아다니는 것들을 옵저버 라고 하죠. 그렇다면 프로그래밍의 세계에서는 무엇을 가지고 옵저버라 칭하는 걸까요 ?

## 발행과 구독

---
위에서 옵저버 패턴은 발행/구독 모델로 알려져 있다고 언급했었습니다. '발행' 과 '구독'이라.. 너무나도 적당하여 옵저버 패턴을 설명할 때 항상 사용되는 예가 있죠. 

신문사가 있습니다. 신문사에서는 신문을 발행하죠. 이 신문을 정기적으로 받아보고 싶은 사람들은 신문사에 전화하여 구독을 신청하면 됩니다. 이 때 신문사에서 알 필요가 있는 정보는 고객의 집 주소 정도이죠. 그 주소로 신문을 보내면 그만이니까요. '누가' 신문을 구독하고 있는지는 중요치 않습니다. 더불어 신문을 받아보는 고객들은 그 날 신문을 어떤 기사로 구성했는지 신문사는 발행 후 무슨 일을 할 것인지, 다른 어떤 고객들이 구독신청을 했는지 알 필요가 없습니다. 그저 본인이 신청한 신문만 제시간에 집에 잘 도착하면 그만인 것이지요. 

단순한 예를 들어봤을 때에도 이 시스템을 구축하는 주요 요인이 하나만은 아니라는 생각이 들겁니다. 최소한 신문을 발행할 신문사와 그것을 구독할 구독자가 있어야 시스템이 돌아가겠죠. 현실 세계에서는 신문사를 발행자, 고객들을 구독자 라고 칭할 수 있을 것입니다. 이러한 구조를 옵저버 패턴으로 옮긴다면 당연히 '발행자' 와 '구독자' 가 있어야 할 것입니다.

## 발행자 (subject)

---
옵저버 패턴에서는 이런 발행자를 주로 **subject(주제)** 라고 부릅니다. subject 들은 본인이 알고 있는 구독자 목록에 '어떤 것' 을 '특정 조건 달성 시' 발행하는 역할을 하죠. 신문사로 예를 들면 조간신문 이라면 매일 아침 이 조건이 될 것이고 특보가 있다면 새롭고 급한 소식이 있을 때가 조건이 될 수 있겠습니다. subject 들은 여러 데이터를 가지고 있을 수 있으며 어떤 데이터가 변경되었을 때 알림을 줄 것인지 결정할 수 있습니다.

## 구독자 (Observer)

---
옵저버 패턴에서 subject 가 발행한 내용을 받을 구독자를 Observer 라고 부릅니다. 네, 패턴의 이름이 되는 옵저버는 여기에서 나온 것이죠. 패턴의 이름이 된다니, 얼마나 중요한지 감이 오시나요? 

보통 옵저버들은 자신이 관심있는 분야의 subject 에게 자신을 등록합니다. 등록은 몇 개의 subject 가 있던 얼마든지 할 수 있죠. 심지어 subject 에게 지금 다른 observer 가 얼마나 등록되어 있는지 어떤 observer 가 등록되어 있는지 신경쓸 필요가 전혀 없습니다. 

observer 는 subject 에 구독을 등록해놓고 신경쓰지 않습니다. 자기의 할 일을 할 뿐입니다. 그러다 발행자에게서 알림이 오면 적당항 행동을 하죠. observer 에게는 이미 subject 에게서 알림이 왔을 때 해야 할 일이 정해져 있고 이에 따라 subject 에서 같은 알림이 올 때마다 해당 행동을 반복합니다. 

## 이벤트에 대한 처리

---
옵저버 패턴을 공부하기 전에는 알지 못했지만 옵저버 패턴의 행동방식을 알고 난 뒤에 보이는 것들이 있습니다. 옵저버 패턴이 적용된 아주 대표적인 예에 해당하는 스윙 및 브라우저 등의 각종 이벤트 처리에 대한 것입니다. 스윙이나 브라우저의 화면에서 버튼이나 체크박스 등의 컴포넌트들을 사용자가 동작시켰을 때 실행되는 메서드들은 프로그램을 개발한 개발자가 직접 호출한 것이 아니죠. 그 메서드들은 특정 조건이 발동하였을 때 실행됩니다. 예를 들면, '버튼을 클릭했을 때', '체크박스에 체크되었을 때' 등이죠. 

메서드나 함수는 코드상에서 명시적으로 호출해주어야 동작합니다. `toString();` 과 같이 말이죠. 하지만 이벤트 발생시 실행되는 위와 같은 메서드, 함수들은 전혀 명시적으로 호출해 준 적이 없을텐데요, 어떻게 동작하는 걸까요? 

